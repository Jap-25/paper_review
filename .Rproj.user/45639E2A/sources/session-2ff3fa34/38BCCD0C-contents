library(pdftools)

pdf_path <- "../papers/stage-0/urban-ai/agarwal-pdfm.pdf"
pages <- pdf_render_page(pdf_path, page = 1, dpi = 300)
png::writePNG(pages, "page1.png")
library(tidyverse)
library(gtrendsR)


autos <- gtrends(
  keyword = c("toyota", "mazda", "subaru"),
  gprop = "web",
  geo = c("CL"),
  time = "all"
)
regiones <- autos$interest_by_region

library(ggplot2)

ggplot(data = regiones) +
  aes(x = reorder(location, hits), fill = keyword, weight = hits) +  # Reorganiza las barras de mayor a menor
  geom_bar() + 
  #scale_fill_brewer(palette = "RdYlBu") + 
  labs(title = "Interés por Departamento",
       x = "Departamento", 
       y = "Interés Relativo") + 
  theme_minimal() + 
  coord_flip()


tiempo <- autos$interest_over_time

ggplot(data = tiempo) + 
  aes(x = date, y = hits, color = keyword) + 
  geom_line() +
  labs(title = "Interés en el Tiempo", x = "Fecha", y = "Interés Relativo") + 
  theme_minimal() + 
  theme(legend.position = 'right')
