<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Fleischmann et al. (2025)">

<title>8&nbsp; The Hierarchical Morphotope Classification – Paper Review: IA y Territorio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./reza-2025.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-485d01fc63b59abcd3ee1bf1e8e2748d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles/style.css">
</head>

<body class="nav-sidebar floating slimcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./urban.html">Urbanismo - IA</a></li><li class="breadcrumb-item"><a href="./fleischmann-2025.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">The Hierarchical Morphotope Classification</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Paper Review: IA y Territorio</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Prefacio</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introducción</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./remote_sensing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Percepción Remota - IA</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./brown-2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Alpha Earth Foundation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fang-2026.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Earth Embeddings as Products</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./urban.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Urbanismo - IA</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./han-2018.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">LLM - Urban Agents</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./agarwal-2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Population Dynamics - FM</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reza-2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Crix - Crime and Demographics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fleischmann-2025.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">The Hierarchical Morphotope Classification</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./presentaciones.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Presentaciones</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./template_paper.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Template</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contenidos</h2>
   
  <ul>
  <li><a href="#información-básica" id="toc-información-básica" class="nav-link active" data-scroll-target="#información-básica"><span class="header-section-number">8.1</span> Información Básica</a></li>
  <li><a href="#abstract" id="toc-abstract" class="nav-link" data-scroll-target="#abstract"><span class="header-section-number">8.2</span> Abstract</a></li>
  <li><a href="#preguntas-de-investigación-hipótesis" id="toc-preguntas-de-investigación-hipótesis" class="nav-link" data-scroll-target="#preguntas-de-investigación-hipótesis"><span class="header-section-number">8.3</span> Preguntas de Investigación / Hipótesis</a></li>
  <li><a href="#metodología" id="toc-metodología" class="nav-link" data-scroll-target="#metodología"><span class="header-section-number">8.4</span> Metodología</a>
  <ul class="collapse">
  <li><a href="#flujo-de-trabajo" id="toc-flujo-de-trabajo" class="nav-link" data-scroll-target="#flujo-de-trabajo"><span class="header-section-number">8.4.1</span> Flujo de trabajo</a></li>
  <li><a href="#modelos-algoritmos" id="toc-modelos-algoritmos" class="nav-link" data-scroll-target="#modelos-algoritmos"><span class="header-section-number">8.4.2</span> Modelos / Algoritmos</a></li>
  <li><a href="#datos" id="toc-datos" class="nav-link" data-scroll-target="#datos"><span class="header-section-number">8.4.3</span> Datos</a></li>
  <li><a href="#validación-uncertainties" id="toc-validación-uncertainties" class="nav-link" data-scroll-target="#validación-uncertainties"><span class="header-section-number">8.4.4</span> Validación &amp; Uncertainties</a></li>
  <li><a href="#replicabilidad-recursos" id="toc-replicabilidad-recursos" class="nav-link" data-scroll-target="#replicabilidad-recursos"><span class="header-section-number">8.4.5</span> Replicabilidad &amp; Recursos</a></li>
  </ul></li>
  <li><a href="#resultados-clave" id="toc-resultados-clave" class="nav-link" data-scroll-target="#resultados-clave"><span class="header-section-number">8.5</span> Resultados Clave</a></li>
  <li><a href="#discusión" id="toc-discusión" class="nav-link" data-scroll-target="#discusión"><span class="header-section-number">8.6</span> Discusión</a></li>
  <li><a href="#aplicabilidad-en-chile" id="toc-aplicabilidad-en-chile" class="nav-link" data-scroll-target="#aplicabilidad-en-chile"><span class="header-section-number">8.7</span> Aplicabilidad en Chile</a></li>
  <li><a href="#madurez-evidencia" id="toc-madurez-evidencia" class="nav-link" data-scroll-target="#madurez-evidencia"><span class="header-section-number">8.8</span> Madurez &amp; Evidencia</a></li>
  <li><a href="#impacto-en-políticas-públicas-ods" id="toc-impacto-en-políticas-públicas-ods" class="nav-link" data-scroll-target="#impacto-en-políticas-públicas-ods"><span class="header-section-number">8.9</span> Impacto en Políticas Públicas / ODS</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./urban.html">Urbanismo - IA</a></li><li class="breadcrumb-item"><a href="./fleischmann-2025.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">The Hierarchical Morphotope Classification</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">The Hierarchical Morphotope Classification</span></h1>
<p class="subtitle lead">A Theory-Driven Framework for Large-Scale Analysis of Built Form</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p><span class="citation" data-cites="fleischmann2025hierarchicalmorphotope">Fleischmann et al. (<a href="references.html#ref-fleischmann2025hierarchicalmorphotope" role="doc-biblioref">2025</a>)</span> </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="información-básica" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="información-básica"><span class="header-section-number">8.1</span> Información Básica</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Elemento</th>
<th>Detalle</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Referencia corta</strong></td>
<td>Fleischmann et al., <em>HiMoC</em> (N/A)</td>
</tr>
<tr class="even">
<td><strong>Título completo</strong></td>
<td>The Hierarchical Morphotope Classification: A Theory-Driven Framework for Large-Scale Analysis of Built Form</td>
</tr>
<tr class="odd">
<td><strong>Revista / Volumen / DOI</strong></td>
<td><a href="https://arxiv.org/abs/2509.10083">https://arxiv.org/abs/2509.10083</a></td>
</tr>
<tr class="even">
<td><strong>Temática</strong></td>
<td>Clasificación morfométrica jerárquica del tejido construido a gran escala (análisis territorial), mediante regionalización y clustering no supervisado basados en teoría de morfología urbana.</td>
</tr>
<tr class="odd">
<td><strong>Contexto / Problema</strong></td>
<td>Las tipologías/clasificaciones de patrones urbanos existentes suelen: (i) carecer de una base teórica fuerte en morfología urbana, (ii) no escalar más allá de ámbitos locales o nacionales, o (iii) perder detalle para lograr cobertura amplia. El trabajo propone un marco que mantenga fundamento teórico (morphotope de Conzen) y, a la vez, sea computacionalmente escalable y reproducible.</td>
</tr>
<tr class="even">
<td><strong>Keywords</strong></td>
<td>urban form; classification; urban morphology; taxonomy; spatial data science</td>
</tr>
<tr class="odd">
<td><strong>Pagina Web</strong></td>
<td><a href="https://urbantaxonomy.org/">https://urbantaxonomy.org/</a></td>
</tr>
<tr class="even">
<td><strong>Repositorio de Código</strong></td>
<td><a href="https://github.com/uscuni/urban_taxonomy">https://github.com/uscuni/urban_taxonomy</a></td>
</tr>
</tbody>
</table>
</section>
<section id="abstract" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="abstract"><span class="header-section-number">8.2</span> Abstract</h2>
<blockquote class="blockquote">
<p><strong>Original:</strong><br>
Built environment, formed of a plethora of patterns of building, streets, and plots, has a profound impact on how cities are perceived and function. While various methods exist to classify urban patterns, they often lack a strong theoretical foundation, are not scalable beyond a local level, or sacrifice detail for broader application. This paper introduces the Hierarchical Morphotope Classification (HiMoC), a novel, theory-driven, and computationally scalable method of classification of built form. HiMoC operationalises the idea of a morphotope – the smallest locality with a distinctive character – using a bespoke regionalisation method SA3 (Spatial Agglomerative Adaptive Aggregation), to delineate contiguous, morphologically distinct localities. These are further organised into a hierarchical taxonomic tree reflecting their dissimilarity based on morphometric profile derived from buildings and streets retrieved from open data, allowing flexible, interpretable classification of built fabric, that can be applied beyond a scale of a single country. The method is tested on a subset of countries of Central Europe, grouping over 90 million building footprints into over 500,000 morphotopes. The method extends the capabilities of available morphometric analyses, while offering a complementary perspective to existing large scale data products, which are focusing primarily on land use or use conceptual definition of urban fabric types. This theory-grounded, reproducible, unsupervised and scalable method facilitates a nuanced understanding of urban structure, with broad applications in urban planning, environmental analysis, and socio-spatial studies.</p>
</blockquote>
<blockquote class="blockquote">
<p><strong>Traducción al español:</strong><br>
El entorno construido, conformado por una multiplicidad de patrones de edificios, calles y parcelas, tiene un impacto profundo en cómo se perciben y funcionan las ciudades. Si bien existen diversos métodos para clasificar patrones urbanos, con frecuencia carecen de una base teórica sólida, no escalan más allá del nivel local o sacrifican detalle para lograr aplicaciones más amplias. Este artículo introduce la Clasificación Jerárquica de Morfotopos (HiMoC), un método novedoso, impulsado por teoría y escalable computacionalmente para clasificar la forma construida. HiMoC operacionaliza la idea de “morphotope” —la localidad más pequeña con un carácter distintivo— mediante un método propio de regionalización, SA3 (Spatial Agglomerative Adaptive Aggregation), para delinear localidades contiguas y morfológicamente distintas. Estas se organizan además en un árbol taxonómico jerárquico que refleja su disimilitud, a partir de un perfil morfométrico derivado de edificios y calles obtenidos desde datos abiertos, permitiendo una clasificación flexible e interpretable del tejido construido que puede aplicarse más allá de la escala de un solo país. El método se prueba en un subconjunto de países de Europa Central, agrupando más de 90 millones de huellas de edificios en más de 500.000 morfotopos. El método amplía las capacidades de análisis morfométricos existentes y ofrece una perspectiva complementaria a productos de datos a gran escala que se enfocan principalmente en uso de suelo o en definiciones conceptuales de tipos de tejido urbano. Este método, fundamentado en teoría, reproducible, no supervisado y escalable, facilita una comprensión matizada de la estructura urbana, con aplicaciones amplias en planificación urbana, análisis ambiental y estudios socio-espaciales.</p>
</blockquote>
</section>
<section id="preguntas-de-investigación-hipótesis" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="preguntas-de-investigación-hipótesis"><span class="header-section-number">8.3</span> Preguntas de Investigación / Hipótesis</h2>
<ul>
<li>¿Puede una clasificación morfométrica <strong>teóricamente fundamentada</strong> (morphotope) escalar de forma <strong>consistente</strong> más allá del nivel nacional usando solo huellas de edificios y red vial? <em>(inferida)</em></li>
<li>¿En qué medida la taxonomía HiMoC se alinea y/o complementa productos existentes (p.&nbsp;ej., CORINE, Urban Atlas, LCZ) al capturar estructura interna del tejido construido? <em>(inferida)</em></li>
</ul>
</section>
<section id="metodología" class="level2 page-columns page-full" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="metodología"><span class="header-section-number">8.4</span> Metodología</h2>
<section id="flujo-de-trabajo" class="level3" data-number="8.4.1">
<h3 data-number="8.4.1" class="anchored" data-anchor-id="flujo-de-trabajo"><span class="header-section-number">8.4.1</span> Flujo de trabajo</h3>
<ol type="1">
<li><strong>Obtención y preprocesamiento de datos</strong>: edificios (polígonos) y calles (líneas), limpieza topológica y estandarización de red vial.</li>
<li><strong>Representación morfológica</strong>: generación de <em>enclosed tessellation</em> (tessellación morfológica dentro de barreras) para aproximar características a nivel “parcela”/entorno inmediato.</li>
<li><strong>Caracterización morfométrica</strong>: cálculo de 59 atributos (edificios, calles, intersecciones, celdas de tessellación) en múltiples escalas.</li>
<li><strong>Delineación de morfotopos</strong>: regionalización contigua con <strong>SA3</strong> (Ward restringido a un grafo de contigüidad) + extracción tipo “leaf” para obtener clusters contiguos; admite “ruido”.</li>
<li><strong>Caracterización a nivel morfotope</strong>: agregación (medianas) de atributos por morfotope + 3 atributos adicionales definidos a este nivel.</li>
<li><strong>Vinculación jerárquica</strong>: clustering aglomerativo de Ward en espacio de atributos para construir un <strong>árbol taxonómico</strong> (sin restricción espacial), acelerado con un grafo kNN (10 vecinos) para reducir costos.</li>
<li><strong>Interpretación</strong>: nominación/descrición de ramas hasta 3 niveles de bifurcación, con “pen portraits” basados en perfiles morfométricos.</li>
<li><strong>Evaluación y comparación</strong>: comparación cuantitativa vía co-ocurrencia/intersección espacial contra productos externos (CORINE, Urban Atlas, LCZ) y evaluación cualitativa con estudios de caso y revisión experta.</li>
</ol>
</section>
<section id="modelos-algoritmos" class="level3 page-columns page-full" data-number="8.4.2">
<h3 data-number="8.4.2" class="anchored" data-anchor-id="modelos-algoritmos"><span class="header-section-number">8.4.2</span> Modelos / Algoritmos</h3>
<blockquote class="blockquote">
<ul>
<li><strong>SA3 (Spatial Agglomerative Adaptive Aggregation)</strong>: regionalización basada en Ward con restricción espacial (contigüidad) + extracción denso-basada (“leaf”) para definir morfotopos contiguos y permitir “ruido”.</li>
<li><strong>Ward Agglomerative Clustering</strong> para construir la jerarquía de morfotopos (árbol taxonómico) en espacio de atributos; aceleración mediante <strong>kNN (k=10)</strong> para limitar cálculos de distancia.</li>
<li><strong>Intersección espacial + matrices de confusión/co-ocurrencia</strong> para comparación con clasificaciones externas (no se reporta “ground truth”).</li>
</ul>
</blockquote>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="images/fleischmann-method.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">Flujo Metodológico.</figcaption>
</figure>
</div>
</section>
<section id="datos" class="level3" data-number="8.4.3">
<h3 data-number="8.4.3" class="anchored" data-anchor-id="datos"><span class="header-section-number">8.4.3</span> Datos</h3>
<p>El método utiliza dos insumos morfológicos principales: <strong>huellas de edificios</strong> como polígonos 2D y <strong>red vial</strong> como líneas (segmentos), complementados por una tessellación morfológica (enclosed tessellation) derivada de ambos. La aplicación empírica cubre seis países contiguos de Europa Central (Austria, Czechia, Germany, Lithuania, Poland, Slovakia) seleccionados por disponibilidad de catastro abierto, diversidad morfológica y conocimiento experto regional. En total, se procesan <strong>&gt;90 millones</strong> de huellas de edificios y <strong>~21 millones</strong> de segmentos viales. El estudio reconoce que este input omite dimensiones como altura de edificios, límites de parcelas y algunos espacios abiertos explícitos, y que la consistencia de los datos condiciona la transferibilidad.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Tipo</th>
<th>Fuente</th>
<th>Cobertura temporal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Huellas de edificios (polígonos 2D)</td>
<td>Catastros oficiales abiertos de cada país (INSPIRE)</td>
<td>N/A (no especificada)</td>
</tr>
<tr class="even">
<td>Red vial (líneas/segmentos)</td>
<td>Overture Maps (Transportation theme; derivado de OpenStreetMap)</td>
<td>N/A (no especificada)</td>
</tr>
<tr class="odd">
<td>Datos de comparación (uso/cobertura de suelo)</td>
<td>CORINE Land Cover</td>
<td>N/A (no especificada en el texto principal)</td>
</tr>
<tr class="even">
<td>Datos de comparación (urbano)</td>
<td>Copernicus Urban Atlas</td>
<td>N/A (no especificada en el texto principal)</td>
</tr>
<tr class="odd">
<td>Datos de comparación (clima/tejido urbano proxy)</td>
<td>Local Climate Zones (predicción global citada en el paper)</td>
<td>N/A (no especificada)</td>
</tr>
</tbody>
</table>
</section>
<section id="validación-uncertainties" class="level3 page-columns page-full" data-number="8.4.4">
<h3 data-number="8.4.4" class="anchored" data-anchor-id="validación-uncertainties"><span class="header-section-number">8.4.4</span> Validación &amp; Uncertainties</h3>
<p>La validación se plantea como un problema <strong>sin “ground truth”</strong>: en lugar de exactitud supervisada, el estudio evalúa (i) <strong>comparación cuantitativa</strong> con productos que capturan conceptos adyacentes (uso/cobertura de suelo, continuidad/densidad urbana, LCZ) mediante intersección espacial y matrices de co-ocurrencia; y (ii) <strong>evaluación cualitativa</strong> basada en observación visual y conocimiento experto en estudios de caso (diferentes tamaños de asentamiento y regiones). Entre las incertidumbres, se explicita la dependencia de <strong>consistencia y disponibilidad</strong> de entradas (huellas de edificios y calles) y el potencial desacople conceptual entre la morfología (HiMoC) y clasificaciones externas (en especial LCZ).</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="images/fleischmann-map.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">Resultados en la Ciudad de Praga.</figcaption>
</figure>
</div>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Métrica</th>
<th>Valor</th>
<th>Alcance</th>
<th>Notas</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Nº de morfotopos delineados</td>
<td>&gt;500.000</td>
<td>Europa Central (6 países)</td>
<td>Resultado de SA3 sobre ~90M edificios</td>
</tr>
<tr class="even">
<td>Tamaño medio de morfotope</td>
<td>132 edificios</td>
<td>Europa Central (6 países)</td>
<td>Reportado como media</td>
</tr>
<tr class="odd">
<td>Tamaño máximo de morfotope</td>
<td>636 edificios</td>
<td>Europa Central (6 países)</td>
<td>Morfotope más grande</td>
</tr>
<tr class="even">
<td>Umbral mínimo para formar morfotope (SA3)</td>
<td>75 edificios</td>
<td>Parámetro del método</td>
<td>Seleccionado para evitar conexiones espurias</td>
</tr>
<tr class="odd">
<td>Vecinos para acelerar Ward (kNN)</td>
<td>10</td>
<td>Construcción del árbol</td>
<td>Reduce requerimientos computacionales; afecta marginalmente la parte alta del árbol</td>
</tr>
</tbody>
</table>
</section>
<section id="replicabilidad-recursos" class="level3" data-number="8.4.5">
<h3 data-number="8.4.5" class="anchored" data-anchor-id="replicabilidad-recursos"><span class="header-section-number">8.4.5</span> Replicabilidad &amp; Recursos</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Ítem</th>
<th>Sí/No</th>
<th>Detalle</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Código disponible</td>
<td>Sí</td>
<td>Repositorio público y archivado en Zenodo; incluye especificación de ambiente reproducible.</td>
</tr>
<tr class="even">
<td>Datos/resultados disponibles</td>
<td>Sí</td>
<td>Producto de datos de la clasificación publicado en Zenodo.</td>
</tr>
<tr class="odd">
<td>Descripción metodológica suficiente</td>
<td>Sí</td>
<td>Método desglosado en 8 pasos + apéndices (atributos, preprocesamiento, etc.).</td>
</tr>
<tr class="even">
<td>Dependencias/herramientas explícitas</td>
<td>Sí</td>
<td>Se mencionan paquetes y contribuciones (p.&nbsp;ej., spopt, momepy, libpysal, shapely, geopandas).</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="resultados-clave" class="level2 page-columns page-full" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="resultados-clave"><span class="header-section-number">8.5</span> Resultados Clave</h2>
<ul>
<li><strong>Escala lograda</strong>: aplicación en seis países, procesando <strong>&gt;90 millones</strong> de huellas de edificios y <strong>~21 millones</strong> de segmentos viales, con <strong>&gt;500.000</strong> morfotopos delineados.</li>
<li><strong>Granularidad operacional</strong>: el árbol taxonómico puede cortarse a distintos niveles (p.&nbsp;ej., ~8 clases para visión general; ~80 o cientos para análisis detallado), manteniendo interpretabilidad mediante descripciones de las ramas superiores.</li>
<li><strong>Estructura jerárquica interpretable</strong>: en el nivel superior se distingue <strong>tejido “Coherent” vs “Incoherent”</strong>; a niveles siguientes se separan patrones densos/interconectados y patrones de distinta escala (large-scale/small-scale), reflejando diferencias morfológicas en edificios y calles.</li>
<li><strong>Distribución por país (nivel 3)</strong>: se reportan diferencias sistemáticas entre países; por ejemplo, <strong>Coherent Dense Disjoint Fabric</strong> alcanza ~0.56 de los edificios en Alemania y ~0.51 en Eslovaquia, mientras en otros países ronda ~0.13–0.18.</li>
<li><strong>Comparación con LCZ (contexto de discrepancias)</strong>: en LCZ, ~47% de edificios se asignan a “Open low-rise” (y ~27% a “Sparsely built”), mientras que en HiMoC las clases más frecuentes a nivel 3 incluyen “Incoherent Small-Scale Compact Fabric” (~42%) y dos clases con ~15% cada una (“Coherent Dense Disjoint Fabric” e “Incoherent Small-Scale Sparse Fabric”), sugiriendo desacoples conceptuales y limitaciones de LCZ para capturar asentamientos pequeños.</li>
</ul>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="images/fleischmann-radial.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">Visión general de la taxonomía jerárquica jerárquica de morfotope, que muestra la repre- radial Sentación de los niveles superiores del árbol taxonómico, una muestra de su perfil morfométrico, abundancia y dos morfotopos de ejemplo para cada rama.</figcaption>
</figure>
</div>
</section>
<section id="discusión" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="discusión"><span class="header-section-number">8.6</span> Discusión</h2>
<ul>
<li><strong>Contribuciones:</strong>
<ul>
<li>Propone un marco <strong>teoría-dirigido</strong> (morphotope) pero <strong>computacional y escalable</strong> para clasificar forma construida más allá del nivel nacional.</li>
<li>Introduce <strong>SA3</strong> para delineación contigua de morfotopos y construye una <strong>taxonomía jerárquica</strong> flexible e interpretable.</li>
<li>Argumenta complementariedad con productos a gran escala centrados en uso de suelo o definiciones conceptuales de tipos de tejido.</li>
</ul></li>
<li><strong>Limitaciones:</strong>
<ul>
<li>Aplicabilidad condicionada por <strong>disponibilidad y consistencia</strong> de huellas de edificios y red vial; datos alternativos pueden ser heterogéneos o inconsistentes (p.&nbsp;ej., OSM/derivados o footprints de terceros).</li>
<li>Entrada limitada a 2D (sin altura; sin parcelas explícitas ni open space detallado), lo que puede restringir ciertos tipos de inferencia o desagregación.</li>
<li>Evaluación sin ground truth; comparaciones externas dependen de marcos conceptuales distintos.</li>
</ul></li>
<li><strong>Futuro:</strong>
<ul>
<li>Extensión a otros contextos geográficos conforme mejore la disponibilidad/armonización de datos.</li>
<li>Investigación orientada a extraer conocimiento del árbol (p.&nbsp;ej., relación con límites políticos, propiedades ambientales, y distribución de grupos poblacionales).</li>
</ul></li>
</ul>
</section>
<section id="aplicabilidad-en-chile" class="level2" data-number="8.7">
<h2 data-number="8.7" class="anchored" data-anchor-id="aplicabilidad-en-chile"><span class="header-section-number">8.7</span> Aplicabilidad en Chile</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Aspecto</th>
<th>Evaluación</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Disponibilidad de huellas de edificios 2D (cobertura y consistencia)</td>
<td><strong>Condicionante crítica.</strong> El método requiere polígonos de edificios relativamente consistentes a gran escala; si la cobertura es parcial o heterogénea, habría que armonizar/normalizar antes de aplicar.</td>
</tr>
<tr class="even">
<td>Disponibilidad/limpieza de red vial (representación morfológica, no solo transporte)</td>
<td><strong>Requiere preprocesamiento.</strong> La red debe simplificarse para reflejar “percepción morfológica” (centrelines, eliminación de artefactos), lo que implica un pipeline de limpieza similar al del paper.</td>
</tr>
<tr class="odd">
<td>Transferencia conceptual de tipos</td>
<td><strong>Alta.</strong> La lógica de “morfotopos” y taxonomía jerárquica es agnóstica al país, pero los nombres/pen portraits podrían necesitar adaptación interpretativa al contexto chileno.</td>
</tr>
<tr class="even">
<td>Evaluación local</td>
<td><strong>Necesaria.</strong> Dado que no hay ground truth, se recomienda comparar con productos nacionales (si existen) y validar con expertos locales/estudios de caso (barrios formales, conjuntos de vivienda social, zonas industriales, periurbano).</td>
</tr>
<tr class="odd">
<td>Potencial de uso público</td>
<td><strong>Alto (si hay datos).</strong> Permite análisis comparables entre ciudades/territorios y monitoreo de patrones de forma urbana sin depender de categorías de uso de suelo.</td>
</tr>
</tbody>
</table>
</section>
<section id="madurez-evidencia" class="level2" data-number="8.8">
<h2 data-number="8.8" class="anchored" data-anchor-id="madurez-evidencia"><span class="header-section-number">8.8</span> Madurez &amp; Evidencia</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Eje</th>
<th>Nivel</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Fundamentación teórica</td>
<td>Alta</td>
</tr>
<tr class="even">
<td>Escalabilidad demostrada</td>
<td>Alta</td>
</tr>
<tr class="odd">
<td>Reproducibilidad (código/datos)</td>
<td>Alta</td>
</tr>
<tr class="even">
<td>Validación empírica (contra referencias externas)</td>
<td>Media</td>
</tr>
<tr class="odd">
<td>Generalización a otros países/continentes</td>
<td>Media (depende de datos)</td>
</tr>
</tbody>
</table>
</section>
<section id="impacto-en-políticas-públicas-ods" class="level2" data-number="8.9">
<h2 data-number="8.9" class="anchored" data-anchor-id="impacto-en-políticas-públicas-ods"><span class="header-section-number">8.9</span> Impacto en Políticas Públicas / ODS</h2>
<p>Al ofrecer una clasificación interpretable y multi-escala del <strong>tejido construido</strong> (más allá del uso de suelo), HiMoC puede apoyar diagnósticos y focalización de políticas urbanas: planificación y diseño urbano, evaluación de forma urbana en relación con desempeño ambiental (p.&nbsp;ej., islas de calor, ventilación, exposición), y análisis socio-espacial (segregación, accesibilidad, tipologías residenciales) con un lenguaje común de “tipos morfológicos”. Se alinea especialmente con <strong>ODS 11 (Ciudades y comunidades sostenibles)</strong> y puede contribuir indirectamente a <strong>ODS 13 (Acción por el clima)</strong> cuando se usa para evaluar vulnerabilidades y adaptación urbana basadas en estructura física del territorio.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-fleischmann2025hierarchicalmorphotope" class="csl-entry" role="listitem">
Fleischmann, Martin, Krasen Samardzhiev, Anna Brázdová, Daniela Dančejová, and Lisa Winkler. 2025. <span>“The Hierarchical Morphotope Classification: A Theory-Driven Framework for Large-Scale Analysis of Built Form.”</span> <a href="https://arxiv.org/abs/2509.10083">https://arxiv.org/abs/2509.10083</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./reza-2025.html" class="pagination-link" aria-label="Crix - Crime and Demographics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Crix - Crime and Demographics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link" aria-label="References">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2025, Denis Berroeta</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>